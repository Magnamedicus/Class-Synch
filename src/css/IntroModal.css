:root {
    /* Theme */
    --im-overlay: hsl(222 16% 8% / 0.62);
    --im-radius: 1.25rem;
    --im-shadow-lg: 0 1.2rem 3.2rem rgba(0, 0, 0, 0.55);

    --im-primary-1: #00d4aa;
    --im-primary-2: #00c2ff;

    /* Desktop-ish defaults */
    --im-dialog-w: min(72rem, 96vw);
    --im-dialog-h: min(90vh, 56rem);

    /* Mat (gap around the image) */
    --im-gap: 0.85rem;

    /* Border thickness for the neon frame */
    --im-frame: 2px;
}

/* ===== Overlay ===== */
.im-overlay {
    position: fixed;
    inset: 0;
    background: var(--im-overlay);
    -webkit-backdrop-filter: blur(12px);
    backdrop-filter: blur(12px);
    display: grid;
    place-items: center;
    z-index: 10050;
    /* Prevent right-edge nudge on iOS when scrollbars show/hide */
    padding: max(1rem, env(safe-area-inset-top, 0)) max(1rem, env(safe-area-inset-right, 0))
    max(1rem, env(safe-area-inset-bottom, 0)) max(1rem, env(safe-area-inset-left, 0));
    animation: im-fade 220ms ease-out;
    box-sizing: border-box;
}

/* ===== Dialog card ===== */
.im-dialog.im-dialog--immersive {
    position: relative;
    width: var(--im-dialog-w);
    height: var(--im-dialog-h);
    max-width: 100vw;      /* hard cap to viewport */
    max-height: 100vh;
    border-radius: var(--im-radius);
    overflow: hidden;
    outline: none;
    background: #0b1020;   /* fallback while image loads */
    box-shadow: var(--im-shadow-lg);
    animation: im-pop 260ms cubic-bezier(.2,.8,.2,1);
    isolation: isolate;
    box-sizing: border-box; /* include borders/pseudo in sizing */
}

/* Big neon/gradient frame that pops against the page */
.im-dialog--frame::before {
    content: "";
    position: absolute;
    inset: 0;
    border-radius: inherit;
    background:
            radial-gradient(120% 120% at 10% -10%, rgba(0,210,170,.22), transparent 60%),
            radial-gradient(120% 120% at 110% 10%, rgba(0,194,255,.20), transparent 60%),
            linear-gradient(135deg, rgba(0,210,170,.12), rgba(0,194,255,.12));
    pointer-events: none;
    filter: blur(18px) saturate(120%);
}
.im-dialog--frame::after {
    content: "";
    position: absolute;
    inset: 0;
    border-radius: inherit;
    padding: var(--im-frame); /* visible frame thickness */
    background: linear-gradient(135deg, #00d4aa, #00c2ff);
    -webkit-mask:
            linear-gradient(#000 0 0) content-box,
            linear-gradient(#000 0 0);
    -webkit-mask-composite: xor;
    mask-composite: exclude;
    pointer-events: none;
    box-shadow: inset 0 0 0 1px rgba(255,255,255,.04);
}

/* ===== Inset canvas (mat around the image) ===== */
.im-canvas {
    position: absolute;
    /* Clamp the gap so itâ€™s generous on desktop but tiny on phones */
    inset: clamp(8px, 2.5vw, var(--im-gap));
    border-radius: calc(var(--im-radius) - clamp(8px, 2.5vw, var(--im-gap)));
    overflow: hidden;
    background: #0b1020;
}

/* Blurred/dimmed backdrop to fill letterboxing while image is 'contain' */
.im-backdrop {
    position: absolute;
    inset: 0;
    background-position: center;
    background-size: cover;
    filter: blur(18px) saturate(110%);
    transform: scale(1.08);
    opacity: 0.35;
}

/* Main image: show entire artwork (no cropping) */
.im-img-bleed {
    position: absolute;
    inset: 0;
    width: 100%;
    height: 100%;
    object-fit: contain;   /* no cropping on top text */
    display: block;
    opacity: 0;
    transform: translateY(4px) scale(1.01);
    animation: im-reveal 360ms 80ms ease-out forwards;
}

/* CTA overlay at bottom with gradient scrim for legibility */
.im-cta {
    position: absolute;
    left: 0;
    right: 0;
    bottom: 0;

    background:
            linear-gradient(
                    180deg,
                    rgba(0, 0, 0, 0.00) 0%,
                    rgba(0, 0, 0, 0.22) 36%,
                    rgba(0, 0, 0, 0.44) 68%,
                    rgba(0, 0, 0, 0.62) 100%
            );

    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.85rem;

    padding:
            calc(env(safe-area-inset-bottom, 0) + 0.95rem)
            0.9rem
            calc(env(safe-area-inset-bottom, 0) + 1.2rem);
}

/* Optional small note (left of button) */
.im-note {
    color: rgba(255, 255, 255, 0.92);
    font-size: 0.95rem;
    letter-spacing: .01em;
    text-shadow: 0 1px 2px rgba(0,0,0,.35);
}

/* CTA button */
.im-btn {
    appearance: none;
    border: none;
    padding: 0.88rem 1.25rem;
    border-radius: 0.85rem;
    font-weight: 800;
    letter-spacing: .02em;
    cursor: pointer;
    transition: transform .12s ease, box-shadow .12s ease, opacity .12s ease, filter .12s ease;
    will-change: transform;
}
.im-btn--primary {
    background: linear-gradient(135deg, var(--im-primary-1), var(--im-primary-2));
    color: white;
    box-shadow: 0 0.6rem 1.5rem rgba(0, 194, 255, 0.28);
}
.im-btn--primary:hover { transform: translateY(-1px); box-shadow: 0 0.8rem 1.85rem rgba(0, 194, 255, 0.33); filter: brightness(1.03); }
.im-btn--primary:active { transform: translateY(0); filter: brightness(0.98); }
.im-btn--primary:focus-visible {
    outline: 2px solid rgba(0,194,255,.9);
    outline-offset: 2px;
    box-shadow: 0 0 0 4px rgba(0,194,255,.18);
}

/* Animations */
@keyframes im-fade { from { opacity: 0; } to { opacity: 1; } }
@keyframes im-pop  { from { opacity: 0; transform: translateY(10px) scale(0.985);} to { opacity: 1; transform: translateY(0) scale(1);} }
@keyframes im-reveal { to { opacity: 1; transform: translateY(0) scale(1);} }

/* ===== Mobile tweaks ===== */
@media (max-width: 480px) {
    :root {
        /* Slightly smaller card on phones */
        --im-dialog-w: 92vw;
        --im-dialog-h: 82vh;
        /* Thinner frame and smaller gap so nothing feels cramped */
        --im-frame: 1.5px;
        --im-gap: 0.6rem;
    }

    .im-cta {
        gap: 0.65rem;
        padding:
                calc(env(safe-area-inset-bottom, 0) + 0.8rem)
                0.75rem
                calc(env(safe-area-inset-bottom, 0) + 1rem);
    }
    .im-btn {
        padding: 0.78rem 1.05rem;
        border-radius: 0.78rem;
        font-size: 0.95rem;
    }
}

/* Reduced motion */
@media (prefers-reduced-motion: reduce) {
    .im-overlay, .im-dialog, .im-img-bleed, .im-btn { animation: none; transition: none; }
}

/* No backdrop-filter fallback */
@supports not ((backdrop-filter: blur(10px))) {
    .im-overlay { background: rgba(0,0,0,.7); }
}
